<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚ö° AGI Studio | MPD218 Controller</title>
    <!-- Chargement de la feuille de style CSS -->
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/modalSystem.css">
    <!-- Font Awesome pour les ic√¥nes (Play, Stop, Prise, etc.) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>

    <div class="l-dashboard">
        
        <!-- ============================================== -->
        <!-- 1. HEADER : Nom du Projet et Commandes Globales -->
        <!-- ============================================== -->
        <header class="l-header c-navbar">
            <div class="c-logo">AGI Studio </div>
            <div class="c-transport-controls">
                <!-- Boutons de Transport -->
                <button class="c-btn c-btn--play" id="btn-play"><i class="fas fa-play"></i></button>
                <button class="c-btn c-btn--stop" id="btn-stop"><i class="fas fa-stop"></i></button>
                <button class="c-btn c-btn--rec" id="btn-rec"><i class="fas fa-circle"></i></button>
                <div class="c-tempo-display">BPM: 128</div>
            </div>
            <!-- Indicateur de statut MIDI/Utilisateur -->
            <div class="c-user-profile">
                <i class="fas fa-times-circle" style="color: var(--color-accent-red);"></i> MIDI D√âCONNECT√â
            </div>
        </header>

        <!-- ============================================== -->
        <!-- 2. MAIN CONTAINER : Le S√©quenceur Principal (Piano Roll) -->
        <!-- ============================================== -->
        <main class="l-main l-canvas" style="display: flex; flex-direction: column; gap: 10px; overflow: hidden;">
            
            <section id="visual-stage" class="c-visual-stage" style="padding: 0; position: relative;">
                <canvas id="main-visual-canvas" style="width: 100%; height: 100%; display: block;"></canvas>
            </section>

            <section id="timeline-arranger" class="c-timeline-container">
                <div class="c-timeline-header">
                    <span class="c-track-name">Global Track</span>
                    <div class="c-timeline-tools">
                        <button class="c-btn-mini" onclick="modalSystem.show('Config Timeline', '<p>Options de dur√©e et de signature rythmique ici...</p>')"><i class="fas fa-cog"></i></button>
                    </div>
                </div>
                <div class="c-timeline-tracks">
                    <div class="c-track-lane">
                        <div class="c-clip-block" style="left: 0%; width: 25%;">Intro (Pattern A)</div>
                        <div class="c-clip-block" style="left: 25%; width: 50%;">Main Loop (Pattern B)</div>
                    </div>
                    <div class="c-playhead" id="global-playhead"></div>
                </div>
            </section>
            
            <section class="c-sequencer-module" style="flex-grow: 1;">
                <aside class="c-sequencer-header" id="sample-names-grid">
                    <div class="c-sequencer-label">NOTES</div>
                </aside>
                <div class="c-sequencer-timeline" id="timeline-grid">
                    </div>
            </section>

        </main>
        <!-- ============================================== -->
        <!-- 3. ASIDE GAUCHE : Bouton de Contr√¥le MIDI (Minimaliste) -->
        <!-- ============================================== -->
        <aside class="l-aside--left c-control-panel" id="control-panel">
            <h3 class="c-panel-title">üéπ Contr√¥leur MIDI</h3>
            
            <!-- AFFICHAGE DES PARAM√àTRES CRITIQUES (SANS LE KNOB) -->
            <div class="c-param-summary">
                <p>Volume: <span id="summary-vol">1.00</span></p>
                <p>V√©locit√©: <span id="summary-vel">1.00</span></p>
                <p>Cl√©: <span id="summary-key">C (Do)</span></p>
            </div>
            
            <hr style="margin-bottom: 20px;">
            
            <!-- BOUTON D√âCLENCHEUR MODAL -->
            <button class="c-btn c-btn--play" id="btn-show-midi-modal" style="width: 100%;">
                <i class="fas fa-sliders-h"></i> Ouvrir Contr√¥leur
            </button>
        </aside>

        <!-- ============================================== -->
        <!-- 4. FOOTER : Console et Visualisation -->
        <!-- ============================================== -->
        <footer class="l-footer">
            <div class="c-status-log" id="status-log">Console: Initialisation en cours...</div>
            <div class="canvas-visualizer" id="canvas-visualizer">
                <!-- Le Canvas sera utilis√© pour la visualisation audio (V2.2) -->
                <canvas id="audio-canvas" width="200" height="40"></canvas>
            </div>
        </footer>

    </div>

    <!-- Librairies et Scripts -->
    <!-- Tone.js pour la synth√®se sonore dans le navigateur -->
    <!-- Socket.io pour la communication WebSocket/OSC -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    
    <!-- Chargement Modulaire des Logiques -->
    <script src="../js/modalSystem.js"></script>
    <script src="../js/recorder.js"></script>
    <script src="../js/sequencer.js"></script>
    <script src="../js/pad.js"></script>
    <script src="../js/midi_modal.js"></script> 
    <script src="../js/script.js"></script>
    <script src="../js/eventKeyboatd.js"></script>
    <script src="../js/visualizer.js"></script>
</body>
</html>