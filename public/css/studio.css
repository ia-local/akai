/* =========================================
   STUDIO MASTER STYLES (V1.6 - IMMERSIVE MODE)
   Layout: Full Overlay / Auto-Collapse Drawers
   ========================================= */

/* --- 1. GLOBAL RESET & LAYOUT --- */
body { 
    margin: 0; 
    overflow: hidden; 
    font-family: 'Inter', sans-serif; 
    background-color: #121212; 
    color: #ddd;
    display: flex;
    flex-direction: column;
    height: 100vh;
}

/* --- 2. HEADER & FOOTER (FIXED) --- */
header {
    height: 50px;
    background-color: #1e1e1e;
    border-bottom: 1px solid #333;
    padding: 0 1rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-shrink: 0;
    z-index: 200; /* Au-dessus de tout */
    position: relative;
}

#studio-footer {
    height: 40px; 
    background-color: #151515; 
    border-top: 1px solid #333;
    display: flex; 
    justify-content: center; 
    gap: 4px; 
    flex-shrink: 0; 
    z-index: 200; /* Au-dessus de la timeline rétractée */
    position: relative;
}

.nav-tab {
    background: none; border: none; color: #666; font-size: 0.8rem; font-weight: bold;
    padding: 0 15px; cursor: pointer; display: flex; align-items: center; gap: 6px;
    border-bottom: 3px solid transparent; transition: all 0.2s;
}
.nav-tab:hover { color: #aaa; background: #1e1e1e; }
.nav-tab.active { color: #ddd; border-bottom-color: #d6455d; background: #252525; }

/* --- 3. WORKSPACE (Zone Centrale Pleine Page) --- */
#workspace {
    flex: 1;
    position: relative; /* Référentiel pour les absolute */
    overflow: hidden;
    background-color: #0d0d0d;
    display: flex;
}

/* CENTER AREA : Prend toute la place maintenant */
#center-area {
    width: 100%;
    height: 100%;
    position: absolute; /* Fond complet */
    top: 0; left: 0;
    z-index: 1; /* Le plus bas */
    display: flex;
    flex-direction: column;
    padding-bottom: 40px; /* Espace pour le header de timeline visible */
    padding-left: 40px;
    padding-right: 40px;
}

/* --- 4. PREVIEW ZONE --- */
#preview-zone {
    flex: 1;
    background-color: #000;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    position: relative;
}

#preview-media-container {
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
}

/* Couches de rendu (Z-Index local) */
.preview-player {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    object-fit: contain; opacity: 0; pointer-events: none;
    transition: opacity 0.2s;
}
.preview-player.active { opacity: 1; }

#player-video { z-index: 5; opacity: 1; }
#webgl-canvas { z-index: 10; mix-blend-mode: screen; opacity: 0; }
#ascii-canvas { min-width: 100%;z-index: 15; opacity: 0; }
#paint-layer  { z-index: 20; opacity: 1; }
#drawing-layer { z-index: 30; pointer-events: none; }

/* Mode Quantum (Activé par JS) */
#preview-media-container.mode-quantum #player-video { opacity: 0 !important; }
#preview-media-container.mode-quantum #webgl-canvas { opacity: 1 !important; mix-blend-mode: normal !important; }

/* --- 5. PANNEAUX LATÉRAUX (ASIDE DRAWERS) --- */
/* Structure commune */
.collapsed-aside {
    position: absolute;
    top: 0; bottom: 0;
    width: 300px; /* Largeur totale déployée */
    z-index: 100; /* Au-dessus du Center Area */
    display: flex;
    transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    /* Note: Pas de pointer-events: none ici sinon on ne peut pas hover le trigger */
}

.aside-content {
    flex: 1;
    background-color: rgba(26, 26, 26, 0.95); /* Légère transparence */
    backdrop-filter: blur(5px);
    border: 1px solid #333;
    display: flex; flex-direction: column; overflow: hidden;
    box-shadow: 0 0 30px rgba(0,0,0,0.8);
}

.aside-trigger {
    width: 30px;
    height: 100%;
    background-color: #111;
    border: 1px solid #333;
    display: flex; flex-direction: column; align-items: center; padding-top: 15px;
    cursor: pointer; color: #666; z-index: 101;
    transition: background 0.2s, color 0.2s;
}
.aside-trigger:hover { background-color: #252525; color: #fff; }
.trigger-icon { font-size: 1.2rem; margin-bottom: 10px; }
.vertical-text { writing-mode: vertical-rl; transform: rotate(180deg); font-size: 0.7rem; font-weight: bold; letter-spacing: 2px; }

/* -- LEFT ASIDE (GAUCHE) -- */
.left-aside {
    left: 0;
    flex-direction: row-reverse; /* Trigger à droite du contenu */
    /* On cache le contenu (270px) en laissant le trigger (30px) visible */
    transform: translateX(-270px);
}
.left-aside:hover { transform: translateX(0); }
.left-aside .aside-trigger { border-left: none; }

/* -- RIGHT ASIDE (DROITE) -- */
.right-aside {
    right: 0;
    flex-direction: row; /* Trigger à gauche du contenu */
    /* On cache le contenu (270px) en laissant le trigger (30px) visible */
    transform: translateX(270px);
}
.right-aside:hover { transform: translateX(0); }
.right-aside .aside-trigger { border-right: none; }


/* --- 6. TIMELINE (BOTTOM DRAWER) --- */
#timeline-editor {
    position: absolute;
    bottom: 0; left: 0; right: 0;
    height: 300px; /* Hauteur déployée */
    background-color: rgba(30, 30, 30, 0.98);
    border-top: 2px solid #333;
    display: flex; flex-direction: column;
    z-index: 90; /* Au-dessus du Center Area, en dessous des Asides */
    transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    
    /* Par défaut : Caché, sauf une bande de 30px (le header) */
    transform: translateY(calc(100% - 30px)); 
}

/* Au survol, on déploie */
#timeline-editor:hover {
    transform: translateY(0);
    box-shadow: 0 -10px 50px rgba(0,0,0,0.8);
}

.timeline-header {
    height: 30px;
    background-color: #252525;
    border-bottom: 1px solid #333;
    display: flex; align-items: center; justify-content: space-between; padding: 0 10px;
    cursor: n-resize; /* Indique que c'est une zone active */
}
.timeline-header:hover { background-color: #333; }

#timeline-content-wrapper { flex: 1; position: relative; overflow: auto; }

/* Elements Timeline */
#timecode-area { height: 25px; background: #2a2a2a; border-bottom: 1px solid #444; position: sticky; top: 0; z-index: 40; }
#playhead { position: absolute; top: 0; bottom: 0; width: 1px; background: red; z-index: 60; pointer-events: none; border-left: 1px solid rgba(255,0,0,0.5); }
.timeline-track { height: 45px; background: #252525; border: 1px solid #333; position: relative; margin-bottom: 4px; border-radius: 3px; }
.track-label { position: absolute; left: 5px; top: 2px; font-size: 0.6rem; color: #666; pointer-events: none; font-weight: bold; }

/* --- CONTROLS OVERLAY (PLAY/PAUSE) --- */
/* Pour éviter que les contrôles soient cachés par la timeline, on les remonte un peu */
.preview-controls {
    position: absolute;
    bottom: 40px; /* Au-dessus du header timeline rétracté */
    left: 50%; transform: translateX(-50%);
    background: rgba(0,0,0,0.5);
    backdrop-filter: blur(4px);
    border-radius: 20px;
    padding: 5px 20px;
    border: 1px solid rgba(255,255,255,0.1);
    z-index: 80;
    transition: opacity 0.2s;
}
/* On cache les contrôles quand la timeline est ouverte pour ne pas gêner */
#timeline-editor:hover ~ #center-area .preview-controls {
    opacity: 0;
    pointer-events: none;
}
/* --- TIMELINE DRAWER & FOCUS --- */

#timeline-editor {
    position: absolute;
    bottom: 0; left: 0; right: 0;
    height: 300px; /* Hauteur déployée */
    background-color: rgba(30, 30, 30, 0.98);
    
    /* Bordure par défaut (discrète) */
    border-top: 2px solid #333;
    
    display: flex; flex-direction: column;
    z-index: 90; 
    transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94), border-color 0.2s, box-shadow 0.2s;
    
    /* Caché par défaut (sauf header 30px) */
    transform: translateY(calc(100% - 30px)); 
}

/* Au survol : On ouvre le tiroir */
#timeline-editor:hover {
    transform: translateY(0);
    box-shadow: 0 -10px 50px rgba(0,0,0,0.8);
}

/* ÉTAT ACTIF (FOCUS) - Géré par JS */
/* Utilisation de !important pour être sûr que ça s'applique */
#timeline-editor.timeline-focused {
    border-top: 2px solid #1e3a8a !important; /* BLEU SYSTEME */
    box-shadow: 0 -5px 25px rgba(59, 130, 246, 0.3) !important; /* GLOW BLEU */
}

/* Contenu */
.timeline-header {
    height: 30px;
    background-color: #252525;
    border-bottom: 1px solid #333;
    display: flex; align-items: center; justify-content: space-between; padding: 0 10px;
    cursor: pointer;
}

#timeline-content-wrapper { 
    flex: 1; 
    position: relative; 
    overflow: auto; 
    outline: none; /* Enlève le contour bleu par défaut du navigateur */
}

/*
    AJOUTEZ CE BLOC À VOTRE FICHIER CSS PRINCIPAL
*/

/* 1. Définir l'animation de base (sur le corps ou le conteneur principal) */
#preview-media-container {
    /* Propriété critique: assure une animation de 0.3s sur l'opacité */
    transition: opacity 0.3s ease-in-out;
    opacity: 1; /* S'assurer qu'il est visible au départ */
}

/* 2. La classe déclenchée par le JavaScript */
.studio-fade-out {
    /* Rend l'élément invisible */
    opacity: 0 !important; 
    /* pointer-events: none; (Optionnel: pour bloquer les clics pendant la transition) */
}